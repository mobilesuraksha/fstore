<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>F-store | Shopping App</title>
    <meta name="theme-color" content="#FF6B00">
    <link rel="manifest" href="manifest.json">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;500;700;900&display=swap');
        body { font-family: 'Outfit', sans-serif; background-color: #f8fafc; -webkit-tap-highlight-color: transparent; }
        .hide-scroll::-webkit-scrollbar { display: none; }
        .glass { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(12px); }
        .loader { border-top-color: #FF6B00; -webkit-animation: spinner 1.5s linear infinite; animation: spinner 1.5s linear infinite; }
        @keyframes spinner { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="pb-24 select-none bg-slate-50">

    <div id="splash" class="fixed inset-0 bg-white z-[9999] flex flex-col items-center justify-center transition-opacity duration-500">
        <div class="bg-orange-50 p-6 rounded-full mb-4 animate-bounce"><i class="fas fa-shopping-bag text-5xl text-[#FF6B00]"></i></div>
        <h1 class="text-3xl font-black italic tracking-tighter text-slate-800">F-<span class="text-[#FF6B00]">store</span></h1>
    </div>

    <header class="glass sticky top-0 z-50 px-5 py-3 flex justify-between items-center shadow-sm border-b border-slate-100">
        <div class="flex items-center gap-2" onclick="location.reload()">
            <div class="bg-[#FF6B00] text-white w-8 h-8 rounded-lg flex items-center justify-center font-bold italic shadow-lg">F</div>
            <h1 class="text-xl font-black italic tracking-tighter text-slate-800">F-store</h1>
        </div>
        <div class="flex gap-3 items-center">
            <button id="installBtn" onclick="installApp()" class="hidden bg-black text-white px-3 py-1 rounded-full text-[10px] font-bold shadow-md animate-pulse">INSTALL</button>
            <button onclick="openCart()" class="relative p-2 text-slate-600 hover:text-[#FF6B00] transition">
                <i class="fas fa-shopping-basket text-2xl"></i>
                <span id="cartCount" class="absolute top-0 right-0 bg-red-500 text-white text-[9px] w-4 h-4 rounded-full flex items-center justify-center font-bold border border-white">0</span>
            </button>
        </div>
    </header>

    <div class="px-4 pt-4 space-y-4">
        <div class="relative">
            <input id="searchInput" oninput="render()" placeholder="Search anything..." class="w-full bg-white border border-slate-200 pl-10 pr-4 py-3 rounded-xl text-sm font-bold shadow-sm outline-none focus:border-[#FF6B00] focus:ring-2 focus:ring-orange-100 transition">
            <i class="fas fa-search absolute left-4 top-3.5 text-slate-400"></i>
        </div>
        <div class="bg-slate-900 rounded-2xl p-5 text-white shadow-xl relative overflow-hidden h-40 flex flex-col justify-center">
            <div class="z-10 relative">
                <span class="bg-[#FF6B00] px-2 py-1 rounded-md text-[10px] font-bold uppercase tracking-wide">Free Delivery</span>
                <h2 class="text-2xl font-black italic mt-2 leading-none">ORDER ABOVE<br>‚Çπ200</h2>
            </div>
            <i class="fas fa-shipping-fast text-[8rem] text-white/5 absolute -right-4 -bottom-6 -rotate-12"></i>
        </div>
    </div>

    <div class="px-4 mt-6">
        <div class="flex gap-3 overflow-x-auto hide-scroll pb-2">
            <button onclick="filter('All')" class="cat-btn bg-slate-900 text-white px-5 py-2 rounded-xl text-xs font-bold shadow-md whitespace-nowrap">üî• All</button>
            <button onclick="filter('Food')" class="cat-btn bg-white border px-5 py-2 rounded-xl text-xs font-bold shadow-sm whitespace-nowrap text-slate-600">üçî Food</button>
            <button onclick="filter('Fashion')" class="cat-btn bg-white border px-5 py-2 rounded-xl text-xs font-bold shadow-sm whitespace-nowrap text-slate-600">üëï Fashion</button>
            <button onclick="filter('Mobile')" class="cat-btn bg-white border px-5 py-2 rounded-xl text-xs font-bold shadow-sm whitespace-nowrap text-slate-600">üéß Tech</button>
        </div>
    </div>

    <main id="productGrid" class="p-4 grid grid-cols-2 gap-4 mb-4"></main>

    <footer class="bg-white border-t border-slate-200 pt-10 pb-24 mt-8 rounded-t-[2.5rem]">
        <div class="px-8 text-center">
            <div class="bg-[#FF6B00] w-12 h-12 rounded-2xl flex items-center justify-center text-white text-2xl mx-auto mb-4 shadow-lg shadow-orange-200">
                <i class="fas fa-bolt"></i>
            </div>
            <h2 class="text-2xl font-black italic tracking-tighter text-slate-900 mb-2">F-store App</h2>
            <p class="text-xs text-slate-400 font-medium mb-6 leading-relaxed px-4">
                India's fastest growing delivery platform. Food, Fashion, and Electronics delivered in minutes.
            </p>
            
            <div class="flex justify-center gap-6 mb-8">
                <a href="#" class="w-10 h-10 rounded-full bg-slate-50 flex items-center justify-center text-slate-400 hover:bg-pink-50 hover:text-pink-600 transition"><i class="fab fa-instagram text-xl"></i></a>
                <a href="#" class="w-10 h-10 rounded-full bg-slate-50 flex items-center justify-center text-slate-400 hover:bg-blue-50 hover:text-blue-600 transition"><i class="fab fa-facebook text-xl"></i></a>
                <a href="#" class="w-10 h-10 rounded-full bg-slate-50 flex items-center justify-center text-slate-400 hover:bg-red-50 hover:text-red-600 transition"><i class="fab fa-youtube text-xl"></i></a>
            </div>

            <div class="border-t border-slate-100 pt-6">
                <p class="text-[10px] text-slate-400 font-bold uppercase tracking-widest">¬© 2026 F-Store Inc.</p>
                <div class="mt-4 flex justify-center gap-4 text-[10px] text-slate-500 font-bold">
                    <a href="#">Privacy Policy</a> ‚Ä¢ <a href="#">Terms</a> ‚Ä¢ <a href="#">Support</a>
                </div>
            </div>
        </div>
    </footer>

    <div class="fixed bottom-0 w-full bg-white/90 backdrop-blur-xl border-t border-slate-200 px-6 py-3 flex justify-between items-center z-40 rounded-t-[2rem] shadow-2xl">
        <button onclick="location.reload()" class="text-[#FF6B00] flex flex-col items-center gap-1"><i class="fas fa-home text-xl"></i><span class="text-[10px] font-bold">Home</span></button>
        <button onclick="showOrders()" class="text-slate-400 hover:text-slate-900 flex flex-col items-center gap-1"><i class="fas fa-box text-xl"></i><span class="text-[10px] font-bold">Orders</span></button>
        <div class="relative -top-8">
            <button onclick="openCart()" class="bg-[#FF6B00] text-white w-14 h-14 rounded-full flex items-center justify-center shadow-xl shadow-orange-200 border-[5px] border-slate-50"><i class="fas fa-shopping-bag text-xl"></i></button>
        </div>
        <button onclick="shareApp()" class="text-slate-400 hover:text-slate-900 flex flex-col items-center gap-1"><i class="fas fa-share-alt text-xl"></i><span class="text-[10px] font-bold">Share</span></button>
        <a href="admin.html" class="text-slate-400 hover:text-slate-900 flex flex-col items-center gap-1"><i class="fas fa-user-shield text-xl"></i><span class="text-[10px] font-bold">Admin</span></a>
    </div>

    <div id="cartModal" class="fixed inset-0 bg-slate-900/80 hidden z-[60] flex items-end sm:items-center justify-center p-0 sm:p-4 backdrop-blur-sm transition-opacity">
        <div class="bg-white w-full max-w-md rounded-t-[2.5rem] sm:rounded-[2.5rem] p-6 max-h-[90vh] overflow-y-auto shadow-2xl">
            <div class="flex justify-between items-center mb-6 sticky top-0 bg-white z-10 pb-2 border-b">
                <h2 class="text-xl font-black italic text-slate-800">YOUR CART</h2>
                <button onclick="document.getElementById('cartModal').classList.add('hidden')" class="bg-slate-100 w-8 h-8 rounded-full"><i class="fas fa-times"></i></button>
            </div>
            
            <div id="cartList" class="space-y-4 mb-6"></div>
            
            <div class="border-t pt-4 space-y-4" id="checkoutSection">
                <div class="bg-orange-50 p-4 rounded-2xl border border-orange-100">
                    <p class="text-xs font-bold text-slate-400 uppercase mb-2">Payment</p>
                    <div class="flex gap-2">
                        <button onclick="setPay('cod')" id="btn-cod" class="flex-1 py-3 rounded-xl bg-white border border-slate-200 text-xs font-bold shadow-sm">üíµ COD</button>
                        <button onclick="setPay('upi')" id="btn-upi" class="flex-1 py-3 rounded-xl bg-white border border-slate-200 text-xs font-bold shadow-sm">üì± UPI</button>
                    </div>
                    
                    <div id="qrBox" class="hidden mt-4 text-center bg-white p-4 rounded-xl border border-dashed border-slate-300">
                        <p class="text-xs font-bold text-[#FF6B00]">Pay: <span id="payAmt"></span></p>
                        <img id="qrImg" src="" class="w-32 h-32 mx-auto mix-blend-multiply my-2">
                        <p class="text-[10px] bg-slate-100 inline-block px-2 py-1 rounded font-mono">UPI: RISHABHSISODIYA1998@YBL</p>
                        <input id="txnId" placeholder="Enter Transaction ID / Ref No" class="w-full mt-3 p-2 text-center text-xs font-bold border rounded-lg focus:border-[#FF6B00] outline-none">
                    </div>
                </div>

                <div class="space-y-3">
                    <button onclick="getLocation()" id="locBtn" class="w-full py-3 bg-slate-100 rounded-xl text-xs font-bold flex items-center justify-center gap-2 hover:bg-slate-200 transition"><i class="fas fa-map-marker-alt"></i> Auto-Detect Location</button>
                    <div class="grid grid-cols-2 gap-3">
                        <input id="cName" placeholder="Name" class="bg-slate-50 p-3 rounded-xl text-xs font-bold border-none outline-none focus:ring-1 focus:ring-[#FF6B00]">
                        <input id="cPhone" type="tel" placeholder="Mobile" class="bg-slate-50 p-3 rounded-xl text-xs font-bold border-none outline-none focus:ring-1 focus:ring-[#FF6B00]">
                    </div>
                    <textarea id="cAddr" rows="2" placeholder="Full Address" class="w-full bg-slate-50 p-3 rounded-xl text-xs font-bold border-none outline-none focus:ring-1 focus:ring-[#FF6B00]"></textarea>
                </div>

                <div class="flex justify-between items-center pt-2">
                    <div>
                        <p class="text-[10px] text-slate-400 font-bold uppercase">Total</p>
                        <p class="text-xl font-black text-slate-800" id="finalTotal">‚Çπ0</p>
                    </div>
                    <button onclick="placeOrder()" class="bg-[#FF6B00] text-white px-8 py-3 rounded-xl font-black shadow-lg shadow-orange-200 flex items-center gap-2 active:scale-95 transition">
                        ORDER <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="toast" class="fixed top-20 left-1/2 -translate-x-1/2 bg-slate-900 text-white px-6 py-3 rounded-full text-xs font-bold shadow-xl z-[70] opacity-0 transition-all pointer-events-none transform -translate-y-5">Msg</div>

    <script>
        // --- DATA & SYNC ---
        const defaultProds = [
            {id:1, name:"Zinger Burger", price:179, cat:"Food", img:"https://images.unsplash.com/photo-1568901346375-23c9450c58cd?w=400"},
            {id:2, name:"Nike Air Max", price:2999, cat:"Fashion", img:"https://images.unsplash.com/photo-1549298916-b41d501d3772?w=400"},
            {id:3, name:"AirPods Pro", price:1999, cat:"Mobile", img:"https://images.unsplash.com/photo-1588423770674-f281137a3e74?w=400"}
        ];
        let products = JSON.parse(localStorage.getItem('f_products')) || defaultProds;
        if(!localStorage.getItem('f_products')) localStorage.setItem('f_products', JSON.stringify(defaultProds));
        
        let cart = JSON.parse(localStorage.getItem('f_temp_cart')) || [];
        let payMode = 'cod';
        let userLat = null, userLng = null;

        // --- RENDER ---
        function render(cat='All') {
            products = JSON.parse(localStorage.getItem('f_products')); // Always fetch fresh
            const grid = document.getElementById('productGrid');
            const search = document.getElementById('searchInput').value.toLowerCase();
            
            let list = products.filter(p => (cat==='All' || p.cat===cat) && p.name.toLowerCase().includes(search));
            
            grid.innerHTML = list.length ? list.map(p => {
                const inCart = cart.find(c=>c.id===p.id);
                const qty = inCart ? inCart.qty : 0;
                return `
                <div class="bg-white p-3 rounded-2xl shadow-sm border border-slate-100 group">
                    <div class="h-32 w-full rounded-xl overflow-hidden mb-3 relative bg-slate-50">
                        <img src="${p.img}" class="w-full h-full object-cover group-hover:scale-110 transition duration-500">
                        ${qty>0 ? `<span class="absolute top-2 right-2 bg-[#FF6B00] text-white text-[10px] w-5 h-5 flex items-center justify-center rounded-full font-bold shadow">${qty}</span>` : ''}
                    </div>
                    <h3 class="font-bold text-sm truncate text-slate-800">${p.name}</h3>
                    <div class="flex justify-between items-center mt-2">
                        <span class="text-[#FF6B00] font-black">‚Çπ${p.price}</span>
                        ${qty===0 ? `<button onclick="modQty(${p.id},1)" class="bg-slate-900 text-white w-8 h-8 rounded-lg flex items-center justify-center active:scale-90 transition"><i class="fas fa-plus"></i></button>` 
                        : `<div class="flex items-center gap-2 bg-slate-100 p-1 rounded-lg"><button onclick="modQty(${p.id},-1)" class="w-6 h-6 bg-white rounded text-slate-600 font-bold">-</button><span class="text-xs font-bold w-2 text-center">${qty}</span><button onclick="modQty(${p.id},1)" class="w-6 h-6 bg-white rounded text-[#FF6B00] font-bold">+</button></div>`}
                    </div>
                </div>`;
            }).join('') : `<div class="col-span-2 text-center py-10 opacity-50"><p class="font-bold text-sm">No items found</p></div>`;
            
            // Highlight Category
            document.querySelectorAll('.cat-btn').forEach(b => {
                b.className = b.innerText.includes(cat) ? "cat-btn bg-slate-900 text-white px-5 py-2 rounded-xl text-xs font-bold shadow-md whitespace-nowrap" : "cat-btn bg-white border px-5 py-2 rounded-xl text-xs font-bold shadow-sm whitespace-nowrap text-slate-600";
            });
            updateBadge();
        }

        function filter(c){ render(c); }

        // --- CART ---
        function modQty(id, chg) {
            let item = cart.find(c=>c.id===id);
            if(item) {
                item.qty += chg;
                if(item.qty<=0) cart = cart.filter(c=>c.id!==id);
            } else if(chg>0) {
                let p = products.find(x=>x.id===id);
                cart.push({...p, qty:1});
            }
            localStorage.setItem('f_temp_cart', JSON.stringify(cart));
            render(); if(!document.getElementById('cartModal').classList.contains('hidden')) openCart();
            showToast(chg>0 ? "Added to Cart" : "Removed");
        }

        function openCart() {
            if(!cart.length) return showToast("Cart is empty");
            let total = cart.reduce((a,b)=>a+(b.price*b.qty),0);
            document.getElementById('cartList').innerHTML = cart.map(i => `
                <div class="flex justify-between items-center bg-slate-50 p-3 rounded-xl border border-slate-100">
                    <div class="flex items-center gap-3">
                        <img src="${i.img}" class="w-10 h-10 rounded-lg object-cover">
                        <div><p class="font-bold text-xs text-slate-800 line-clamp-1">${i.name}</p><p class="text-[10px] text-slate-400">‚Çπ${i.price}</p></div>
                    </div>
                    <div class="flex items-center gap-3 bg-white px-2 py-1 rounded-lg border">
                        <button onclick="modQty(${i.id}, -1)" class="font-bold text-slate-400">-</button><span class="text-xs font-bold">${i.qty}</span><button onclick="modQty(${i.id}, 1)" class="font-bold text-[#FF6B00]">+</button>
                    </div>
                </div>`).join('');
            
            document.getElementById('finalTotal').innerText = `‚Çπ${total}`;
            document.getElementById('payAmt').innerText = `‚Çπ${total}`;
            document.getElementById('qrImg').src = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=upi://pay?pa=RISHABHSISODIYA1998@YBL&pn=FStore&am=${total}&cu=INR`;
            document.getElementById('cartModal').classList.remove('hidden');
        }

        function setPay(m){ 
            payMode=m; 
            document.getElementById('qrBox').style.display = m==='upi'?'block':'none';
            document.getElementById('btn-cod').className = m==='cod' ? "flex-1 py-3 rounded-xl bg-[#FF6B00] text-white text-xs font-bold shadow-md transition" : "flex-1 py-3 rounded-xl bg-white border border-slate-200 text-xs font-bold shadow-sm";
            document.getElementById('btn-upi').className = m==='upi' ? "flex-1 py-3 rounded-xl bg-[#FF6B00] text-white text-xs font-bold shadow-md transition" : "flex-1 py-3 rounded-xl bg-white border border-slate-200 text-xs font-bold shadow-sm";
        }

        function updateBadge(){ document.getElementById('cartCount').innerText = cart.reduce((a,b)=>a+b.qty,0); }

        // --- LOCATION & ORDER ---
        function getLocation() {
            if(navigator.geolocation) {
                document.getElementById('locBtn').innerHTML = `<i class="fas fa-spin fa-circle-notch"></i> Detecting...`;
                navigator.geolocation.getCurrentPosition(pos => {
                    userLat = pos.coords.latitude; userLng = pos.coords.longitude;
                    document.getElementById('locBtn').innerHTML = `<i class="fas fa-check text-green-500"></i> Location Saved`;
                    document.getElementById('locBtn').classList.add('bg-green-50', 'text-green-700');
                }, () => { alert("Location permission denied. Delivery might be hard."); document.getElementById('locBtn').innerHTML = "Location Denied"; });
            }
        }

        function placeOrder() {
            let name = document.getElementById('cName').value;
            let phone = document.getElementById('cPhone').value;
            let addr = document.getElementById('cAddr').value;
            let txn = document.getElementById('txnId').value;

            if(!name || !phone || !addr) return alert("Fill all details");
            if(payMode==='upi' && !txn) return alert("Enter Transaction ID");

            let order = {
                id: 'ORD'+Math.floor(1000+Math.random()*9000),
                customer: { name, phone, addr, lat: userLat, lng: userLng },
                items: cart,
                total: cart.reduce((a,b)=>a+(b.price*b.qty),0),
                payment: payMode==='upi' ? `Paid (Ref:${txn})` : 'COD',
                status: 'Pending',
                date: new Date().toLocaleString()
            };

            let orders = JSON.parse(localStorage.getItem('f_orders')) || [];
            orders.unshift(order);
            localStorage.setItem('f_orders', JSON.stringify(orders));

            let msg = `*New Order ${order.id}*%0Aüë§ ${name}%0Aüí∞ ‚Çπ${order.total}%0Aüí≥ ${order.payment}`;
            window.open(`https://wa.me/918468966897?text=${msg}`);

            cart = []; localStorage.removeItem('f_temp_cart');
            updateBadge(); document.getElementById('cartModal').classList.add('hidden');
            showToast("Order Placed Successfully!");
        }

        function showOrders(){
            let o = JSON.parse(localStorage.getItem('f_orders')) || [];
            alert(o.length ? o.map(x=>`üì¶ #${x.id} | ${x.status}`).join('\n') : "No orders yet");
        }

        function showToast(m){ 
            let t = document.getElementById('toast'); t.innerText = m; t.style.opacity=1; t.style.transform='translate(-50%,0)';
            setTimeout(()=>{t.style.opacity=0; t.style.transform='translate(-50%,-20px)'}, 2000);
        }

        // Init
        setTimeout(()=>document.getElementById('splash').style.display='none', 1500); render();
        
        let deferredPrompt; window.addEventListener('beforeinstallprompt', (e) => { e.preventDefault(); deferredPrompt = e; document.getElementById('installBtn').classList.remove('hidden'); });
        function installApp() { if(deferredPrompt) { deferredPrompt.prompt(); deferredPrompt.userChoice.then((c) => { if(c.outcome==='accepted') document.getElementById('installBtn').classList.add('hidden'); deferredPrompt=null; }); } }
        if ('serviceWorker' in navigator) navigator.serviceWorker.register('sw.js');
        function shareApp() { navigator.share({title:'F-store', url:window.location.href}); }
    </script>
</body>
</html>